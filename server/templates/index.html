<!DOCTYPE html>
<meta charset="utf-8">
<style>
	.line{
		fill: none;
		stroke: steelblue;
		stroke-width: 2px;
	}

	.area{
		stroke: #000;
		stroke-width: 0.6;
		stroke-linejoin: round;
		opacity: 0.5
	}
</style>
	<head>
		<script src="https://d3js.org/d3.v5.min.js"></script>
		<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
		<script src="http://code.jquery.com/jquery.js"></script>
		<link href="{{ url_for('static', filename = "css/bootstrap.css")}}" rel="stylesheet" media="screen">
		<link rel="stylesheet" href="/resources/demos/style.css">
		<script src="{{ url_for('static', filename = "bootstrap.js") }}"></script>
		<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<script>
				    $( function() {
					    $( "#datepicker" ).datepicker({
						    dateFormat: "yy-mm-dd",
						    minDate: new Date('2019-03-26'),
					    	    maxDate: new Date('2019-05-11')
					    });
					      } );
  </script>
	</head>
	<body>
		<div class="container">
			<br></br>
			<form class = 'user-input' >
				<div class="form-group">
					Date: <input style="display: inline" value="2019-03-25" type="text" id="datepicker" name='date'>
			 		<button style="display: inline" type="submit" class="btn btn-primary">Submit</button>
				</div>
			</form>
			<svg id="arcs"></svg>	
		</div>	
		<div class="container">

			Feature: <select id="featureSelect" class="mdb-select md-form colorful-select dropdown-primary">
				<option value="0" selected="selected">d1</option>
				{% for i in range(1, len) %}
					<option value={{ i }}>{{ features[i] }}</option>
				{% endfor %}
		   	</select>
			<br></br>
			<svg id="density"></svg>
		 </div> 
	<script>
		var margin = {top: 20, right: 20, bottom:20, left: 30},
		    width = 960 - margin.right - margin.left,
		    height = 400 - margin.top - margin.bottom;
	
		var tau = 2*Math.PI;
		var arc_fore = d3.arc()
			.innerRadius(50)
			.outerRadius(70)
			.startAngle(0)
			.endAngle(tau);

		var arc_back = d3.arc()
			.innerRadius(50)
			.outerRadius(70)
			.startAngle(function(d) {return (-0.25+(d.mean/d.max))*tau; })
			.endAngle(0.75*tau);

		var svgArc = d3.select("#arcs")
			.attr("width", width + margin.right + margin.left)
			.attr("height", height + margin.top + margin.bottom);
		console.log(svgArc);

	
		function drawArcs(url){
			d3.json(url).then(function(data){
		
			d3.selectAll(".arc2").remove();
			d3.selectAll(".text1").remove();
			d3.selectAll(".text2").remove();

			var svg = svgArc.selectAll("g")
				.data(d3.values(data.weather))
				.enter()
				.append("g")
				.attr("transform", function(d, i) {return "translate("+ (i*200+160)+" ,200)";})
			
			var svg2 = svgArc.selectAll("g grey")
				.data(d3.values(data.weather))
				.enter()
				.append("g")
				.attr("transform", function(d, i) {return "translate("+ (i*200+160)+" ,200)";})
			
			var svg3 = svgArc.selectAll("g text")
				.data(d3.keys(data.weather))
				.enter()
				.append("g")
				.attr("transform", function(d, i) {return "translate("+ (i*200+120)+" ,320)";})
			var svg4 = svgArc.selectAll("g text-no")
				.data(d3.values(data.weather))
				.enter()
				.append("g")
				.attr("transform", function(d, i) {return "translate("+ (i*200+140)+" ,200)";})
			svg.append("path")
				.attr("class", "arc1")
				.attr("d", arc_fore)
				.style("fill", "orange");

			svg2.append("path")
				.attr("class", "arc2")
				.attr("d", arc_back)
				.style("fill", "#ddd");

			svg3.append("text")
				.attr("class", "text1")
				.text(function(d) {return d;})

			svg4.append("text")
				.attr("class", "text2")
				.text(function(d) {return d.mean.toFixed(2);})
			})};
		
	</script>
	<script src="{{ url_for('static', filename = "density.js")}}"></script>
	<script src="{{ url_for('static', filename = "index.js")}}"></script>
		</div>
	</body>
</html>
